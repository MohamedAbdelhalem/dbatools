if object_id('[dbo].[BAB_multi_values]') is not null
begin
DROP FUNCTION [dbo].[BAB_multi_values]
end
go

CREATE FUNCTION [dbo].[BAB_multi_values](@col varchar(10), @recid varchar(255), @xmlrecord XML)
RETURNS @table table (
[1] varchar(34),[2] varchar(34),[3] varchar(34),[4] varchar(34),[5] varchar(34),[6] varchar(34),[7] varchar(34),[8] varchar(34),[9] varchar(34),[10] varchar(34),
[11] varchar(34),[12] varchar(34),[13] varchar(34),[14] varchar(34),[15] varchar(34),[16] varchar(34),[17] varchar(34),[18] varchar(34),[19] varchar(34),[20] varchar(34),
[21] varchar(34),[22] varchar(34),[23] varchar(34),[24] varchar(34),[25] varchar(34),[26] varchar(34),[27] varchar(34),[28] varchar(34),[29] varchar(34),[30] varchar(34),
[31] varchar(34),[32] varchar(34),[33] varchar(34),[34] varchar(34),[35] varchar(34),[36] varchar(34),[37] varchar(34),[38] varchar(34),[39] varchar(34),[40] varchar(34),
[41] varchar(34),[42] varchar(34),[43] varchar(34),[44] varchar(34),[45] varchar(34),[46] varchar(34),[47] varchar(34),[48] varchar(34),[49] varchar(34),[50] varchar(34),
[51] varchar(34),[52] varchar(34),[53] varchar(34),[54] varchar(34),[55] varchar(34),[56] varchar(34),[57] varchar(34),[58] varchar(34),[59] varchar(34),[60] varchar(34),
[61] varchar(34),[62] varchar(34),[63] varchar(34),[64] varchar(34),[65] varchar(34),[66] varchar(34),[67] varchar(34),[68] varchar(34),[69] varchar(34),[70] varchar(34),
[71] varchar(34),[72] varchar(34),[73] varchar(34),[74] varchar(34),[75] varchar(34),[76] varchar(34),[77] varchar(34),[78] varchar(34),[79] varchar(34),[80] varchar(34),
[81] varchar(34),[82] varchar(34),[83] varchar(34),[84] varchar(34),[85] varchar(34),[86] varchar(34),[87] varchar(34),[88] varchar(34),[89] varchar(34),[90] varchar(34),
[91] varchar(34),[92] varchar(34),[93] varchar(34),[94] varchar(34),[95] varchar(34),[96] varchar(34),[97] varchar(34),[98] varchar(34),[99] varchar(34),[100] varchar(34),
[101] varchar(34),[102] varchar(34),[103] varchar(34),[104] varchar(34),[105] varchar(34),[106] varchar(34),[107] varchar(34),[108] varchar(34),[109] varchar(34),[110] varchar(34),
[111] varchar(34),[112] varchar(34),[113] varchar(34),[114] varchar(34),[115] varchar(34),[116] varchar(34),[117] varchar(34),[118] varchar(34),[119] varchar(34),[120] varchar(34),
[121] varchar(34),[122] varchar(34),[123] varchar(34),[124] varchar(34),[125] varchar(34),[126] varchar(34),[127] varchar(34),[128] varchar(34),[129] varchar(34),[130] varchar(34),
[131] varchar(34),[132] varchar(34),[133] varchar(34),[134] varchar(34),[135] varchar(34),[136] varchar(34),[137] varchar(34),[138] varchar(34),[139] varchar(34),[140] varchar(34),
[141] varchar(34),[142] varchar(34),[143] varchar(34),[144] varchar(34),[145] varchar(34),[146] varchar(34),[147] varchar(34),[148] varchar(34),[149] varchar(34),[150] varchar(34),
[151] varchar(34),[152] varchar(34),[153] varchar(34),[154] varchar(34),[155] varchar(34),[156] varchar(34),[157] varchar(34),[158] varchar(34),[159] varchar(34),[160] varchar(34),
[161] varchar(34),[162] varchar(34),[163] varchar(34),[164] varchar(34),[165] varchar(34),[166] varchar(34),[167] varchar(34),[168] varchar(34),[169] varchar(34),[170] varchar(34),
[171] varchar(34),[172] varchar(34),[173] varchar(34),[174] varchar(34),[175] varchar(34),[176] varchar(34),[177] varchar(34),[178] varchar(34),[179] varchar(34),[180] varchar(34),
[181] varchar(34),[182] varchar(34),[183] varchar(34),[184] varchar(34),[185] varchar(34),[186] varchar(34),[187] varchar(34),[188] varchar(34),[189] varchar(34),[190] varchar(34),
[191] varchar(34),[192] varchar(34),[193] varchar(34),[194] varchar(34),[195] varchar(34),[196] varchar(34),[197] varchar(34),[198] varchar(34),[199] varchar(34),[200] varchar(34),
[201] varchar(34),[202] varchar(34),[203] varchar(34),[204] varchar(34),[205] varchar(34),[206] varchar(34),[207] varchar(34),[208] varchar(34),[209] varchar(34),[210] varchar(34),
[211] varchar(34),[212] varchar(34),[213] varchar(34),[214] varchar(34),[215] varchar(34),[216] varchar(34),[217] varchar(34),[218] varchar(34),[219] varchar(34),[220] varchar(34),
[221] varchar(34),[222] varchar(34),[223] varchar(34),[224] varchar(34),[225] varchar(34),[226] varchar(34),[227] varchar(34),[228] varchar(34),[229] varchar(34),[230] varchar(34),
[231] varchar(34),[232] varchar(34),[233] varchar(34),[234] varchar(34),[235] varchar(34),[236] varchar(34),[237] varchar(34),[238] varchar(34),[239] varchar(34),[240] varchar(34),
[241] varchar(34),[242] varchar(34),[243] varchar(34),[244] varchar(34),[245] varchar(34),[246] varchar(34),[247] varchar(34),[248] varchar(34),[249] varchar(34),[250] varchar(34),
[251] varchar(34),[252] varchar(34),[253] varchar(34),[254] varchar(34),[255] varchar(34),[256] varchar(34),[257] varchar(34),[258] varchar(34),[259] varchar(34),[260] varchar(34),
[261] varchar(34),[262] varchar(34),[263] varchar(34),[264] varchar(34),[265] varchar(34),[266] varchar(34),[267] varchar(34),[268] varchar(34),[269] varchar(34),[270] varchar(34),
[271] varchar(34),[272] varchar(34),[273] varchar(34),[274] varchar(34),[275] varchar(34),[276] varchar(34),[277] varchar(34),[278] varchar(34),[279] varchar(34),[280] varchar(34),
[281] varchar(34),[282] varchar(34),[283] varchar(34),[284] varchar(34),[285] varchar(34),[286] varchar(34),[287] varchar(34),[288] varchar(34),[289] varchar(34),[290] varchar(34),
[291] varchar(34),[292] varchar(34),[293] varchar(34),[294] varchar(34),[295] varchar(34),[296] varchar(34),[297] varchar(34),[298] varchar(34),[299] varchar(34),[300] varchar(34))
WITH SCHEMABINDING
BEGIN
declare @multi_value Varchar(1000)

insert into @table
select 
[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],
[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53],[54],[55],[56],[57],[58],[59],
[60],[61],[62],[63],[64],[65],[66],[67],[68],[69],[70],[71],[72],[73],[74],[75],[76],[77],[78],[79],[80],[81],[82],[83],[84],[85],[86],[87],[88],[89],
[90],[91],[92],[93],[94],[95],[96],[97],[98],[99],[100],[101],[102],[103],[104],[105],[106],[107],[108],[109],[110],[111],[112],[113],[114],[115],[116],
[117],[118],[119],[120],[121],[122],[123],[124],[125],[126],[127],[128],[129],[130],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],
[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[156],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],
[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],
[192],[193],[194],[195],[196],[197],[198],[199],[200],[201],[202],[203],[204],[205],[206],[207],[208],[209],[210],[211],[212],[213],[214],[215],[216],
[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],
[242],[243],[244],[245],[246],[247],[248],[249],[250],[251],[252],[253],[254],[255],[256],[257],[258],[259],[260],[261],[262],[263],[264],[265],[266],
[267],[268],[269],[270],[271],[272],[273],[274],[275],[276],[277],[278],[279],[280],[281],[282],[283],[284],[285],[286],[287],[288],[289],[290],[291],
[292],[293],[294],[295],[296],[297],[298],[299],[300]
from (
select row_number() over(order by tag_no) tag_no, col
from (
select 
row_number() over(order by @recid) tag_no,  
T.C.value('.', 'varchar(34)') col
FROM @XMLRECORD.nodes('(/row/*[local-name(.)=sql:variable("@col")])') as T(C))a
where a.tag_no > 1)b
pivot (
max(col) for tag_no in (
[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23],[24],[25],[26],[27],[28],[29],
[30],[31],[32],[33],[34],[35],[36],[37],[38],[39],[40],[41],[42],[43],[44],[45],[46],[47],[48],[49],[50],[51],[52],[53],[54],[55],[56],[57],[58],[59],
[60],[61],[62],[63],[64],[65],[66],[67],[68],[69],[70],[71],[72],[73],[74],[75],[76],[77],[78],[79],[80],[81],[82],[83],[84],[85],[86],[87],[88],[89],
[90],[91],[92],[93],[94],[95],[96],[97],[98],[99],[100],[101],[102],[103],[104],[105],[106],[107],[108],[109],[110],[111],[112],[113],[114],[115],[116],
[117],[118],[119],[120],[121],[122],[123],[124],[125],[126],[127],[128],[129],[130],[131],[132],[133],[134],[135],[136],[137],[138],[139],[140],[141],
[142],[143],[144],[145],[146],[147],[148],[149],[150],[151],[152],[153],[154],[155],[156],[157],[158],[159],[160],[161],[162],[163],[164],[165],[166],
[167],[168],[169],[170],[171],[172],[173],[174],[175],[176],[177],[178],[179],[180],[181],[182],[183],[184],[185],[186],[187],[188],[189],[190],[191],
[192],[193],[194],[195],[196],[197],[198],[199],[200],[201],[202],[203],[204],[205],[206],[207],[208],[209],[210],[211],[212],[213],[214],[215],[216],
[217],[218],[219],[220],[221],[222],[223],[224],[225],[226],[227],[228],[229],[230],[231],[232],[233],[234],[235],[236],[237],[238],[239],[240],[241],
[242],[243],[244],[245],[246],[247],[248],[249],[250],[251],[252],[253],[254],[255],[256],[257],[258],[259],[260],[261],[262],[263],[264],[265],[266],
[267],[268],[269],[270],[271],[272],[273],[274],[275],[276],[277],[278],[279],[280],[281],[282],[283],[284],[285],[286],[287],[288],[289],[290],[291],
[292],[293],[294],[295],[296],[297],[298],[299],[300]))p

return
end
