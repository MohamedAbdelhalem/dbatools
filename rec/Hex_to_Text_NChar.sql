CREATE FUNCTION [dbo].[Hex_to_Text_NChar] 
(@hex nvarchar(max))
returns nvarchar(max)
as
begin
declare @table table (
t nvarchar(5) Collate SQL_Latin1_General_CP1_CS_AS, 
h nvarchar(5) Collate SQL_Latin1_General_CP1_CS_AS)
insert into @table values 
(N'0','3000'),(N'1','3100'),(N'2','3200'),(N'3','3300'),(N'4','3400'),(N'5','3500'),(N'6','3600'),
(N'7','3700'),(N'8','3800'),(N'9','3900'),
(N'a','6100'),(N'b','6200'),(N'c','6300'),(N'd','6400'),(N'e','6500'),(N'f','6600'),(N'g','6700'),
(N'h','6800'),(N'i','6900'),(N'j','6A00'),(N'k','6B00'),(N'l','6C00'),(N'm','6D00'),(N'n','6E00'),
(N'o','6F00'),(N'p','7000'),(N'q','7100'),(N'r','7200'),(N's','7300'),(N't','7400'),(N'u','7500'),
(N'v','7600'),(N'w','7700'),(N'x','7800'),(N'y','7900'),(N'z','7A00'),
(N'A','4100'),(N'B','4200'),(N'C','4300'),(N'D','4400'),(N'E','4500'),(N'F','4600'),(N'G','4700'),
(N'H','4800'),(N'I','4900'),(N'J','4A00'),(N'K','4B00'),(N'L','4C00'),(N'M','4D00'),(N'N','4E00'),
(N'O','4F00'),(N'P','5000'),(N'Q','5100'),(N'R','5200'),(N'S','5300'),(N'T','5400'),(N'U','5500'),
(N'V','5600'),(N'W','5700'),(N'X','5800'),(N'Y','5900'),(N'Z','5A00'),
(N' ','2000'),(N'-','2D00'),(N'_','5F00'),(N'+','2B00'),(N'%','2500'),
(N'@','4000'),(N'!','2100'),(N'"','2200'),(N'&','2600'),(N'(','2800'),(N')','2900'),(N'*','2A00'),
(N',','2C00'),(N'.','2E00'),(N'/','2F00'),(N'\','5C00'),(N'[','5B00'),(N']','5D00'),
(N'#','2300'),(N'$','2400'),(N':','3A00'),(N';','3B00'),(N'<','3C00'),(N'>','3E00'),(N'=','3D00'),
(N'?','3F00'),(N'¡','0C06'),
(N'Ç','2706'),(N'Ã','2306'),(N'Å','2506'),(N'È','2806'),(N'Ê','2A06'),(N'Ë','2B06'),(N'Ì','2C06'),
(N'Í','2D06'),(N'Î','2E06'),(N'Ï','2F06'),(N'Ð','3006'),(N'Ñ','3106'),(N'Ò','3206'),(N'Ó','3306'),
(N'Ô','3406'),(N'Õ','3506'),(N'Ö','3606'),(N'Ø','3706'),(N'Ù','3806'),(N'Ú','3906'),(N'Û','3A06'),
(N'Ý','4106'),(N'Þ','4206'),(N'ß','4306'),(N'á','4406'),(N'ã','4506'),(N'ä','4606'),(N'å','4706'),
(N'É','2906'),(N'æ','4806'),(N'í','4A06'),(N'ì','4906'),(N'Æ','2606'),(N'Á','2106'),(N'Ä','2406'),
(N'“','1C20'),(N'”','1D20'),(N'''','2700'),(N'{','7B00'),(N'}','7D00'),
(convert(nvarchar(max),0x0A00),'0A00'),
(N'	','0900'),
(convert(nvarchar(max),0x0D00),'0D00'),
(N'0','30'),(N'1','31'),(N'2','32'),(N'3','33'),(N'4','34'),(N'5','35'),(N'6','36'),
(N'7','37'),(N'8','38'),(N'9','39'),(N'a','61'),(N'b','62'),(N'c','63'),(N'd','64'),
(N'e','65'),(N'f','66'),(N'g','67'),(N'h','68'),(N'i','69'),(N'j','6A'),(N'k','6B'),
(N'l','6C'),(N'm','6D'),(N'n','6E'),(N'o','6F'),(N'p','70'),(N'q','71'),(N'r','72'),
(N's','73'),(N't','74'),(N'u','75'),(N'v','76'),(N'w','77'),(N'x','78'),(N'y','79'),
(N'z','7A'),(N'A','41'),(N'B','42'),(N'C','43'),(N'D','44'),(N'E','45'),(N'F','46'),
(N'G','47'),(N'H','48'),(N'I','49'),(N'J','4A'),(N'K','4B'),(N'L','4C'),(N'M','4D'),
(N'N','4E'),(N'O','4F'),(N'P','50'),(N'Q','51'),(N'R','52'),(N'S','53'),(N'T','54'),
(N'U','55'),(N'V','56'),(N'W','57'),(N'X','58'),(N'Y','59'),(N'Z','5A'),(N' ','20'),
(N'-','2D'),(N'_','5F'),(N'+','2B'),(N'%','25'),(N'@','40'),
(N'!','21'),(N'"','22'),(N'&','26'),(N'(','28'),(N')','29'),(N'*','2A'),
(N',','2C'),(N'.','2E'),(N'/','2F'),(N'\','5C'),(N'[','5B'),(N']','5D'),(N'#','23'),
(N'$','24'),(N':','3A'),(N';','3B'),(N'<','3C'),(N'>','3E'),(N'=','3D'),(N'?','3F'),
(N'''','27'),(N'{','7B'),(N'}','7D')

declare 
@convert	nvarchar(5),
@text		nvarchar(5),
@result		nvarchar(max),
@loop		int = 0

while @loop < len(@hex)
begin
set @text = ''
select @convert = substring(@hex,@loop+1,4)
select @text = t
from @table
where h = iif((select h from @table where h = @convert) = @convert, @convert, substring(@convert,1,2))

select @result = isnull(@result,'')+@text
set @loop = @loop + 4
end

return @result
end